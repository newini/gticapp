<div class="row">
  <aside class="col-md-2">
    <section>
      <%= render'side' %>
    </section>
  </aside>

  <div class="col-md-10">
    <h2>メール</h2>
    <br>
    <div class="row">
      <div class="col-md-2"><%= link_to "戻る", :back, class: "btn btn-primary btn-large btn-block"%></div>
      <div class="col-md-2"></div>
      <div class="col-md-2"><%= link_to '編集', edit_invitation_path(@invitation), class:"btn btn-block btn-primary" %></div>
      <div class="col-md-2"></div>
      <div class="col-md-2"><%= link_to '削除', invitation_path(@invitation), method: :delete, class:"btn btn-block btn-primary",
                                data: {confirm: '削除します。よろしいでしょうか？'} %></div>
    </div>
    <div class="col-md-2"></div>

    <hr>

    <% if @invitation.sent_flg %>
      <div class="row">
        <div class="col-md-12">
          <h3>送信済み</h3>
          <p>詳細</p>

          <table class="table table-bordered">
            <tr>
              <th>送信時間</th>
              <td><%= @invitation.sent_at %></td>
            </tr>

            <tr>
              <th>参加者全員</th>
              <td><%= @invitation.include_all_flg %></td>
            </tr>

            <tr>
              <th>誕生月</th>
              <td>
                <% @birth_months.each do |birth_month| %>
                  <%= "#{birth_month}月" %>
                <% end %>
              </td>
            </tr>

            <tr>
              <th>イベント会合</th>
              <td>
                <% @event_ids.each do |event_id| %>
                  <%= "第#{Event.find(event_id).cumulative_number}回" %>
                <% end %>
              </td>
            </tr>

            <tr>
              <th>GTIC幹事メンバー</th>
              <td><%= @invitation.include_gtic_flg %></td>
            </tr>
          </table>
        </div>
      </div>

      <hr>

      <div class="row">
        <div class="col-md-4">
          <%= link_to "送信成功者リスト", view_member_invitation_invitation_path(@invitation), class: "btn btn-default btn-lg" %>
       </div>
      </div>
    <% else %>
      <div class="row">
        <div class="col-md-12">
          <h3>送信オプション</h3>
          <p>㊟ブラックリストメンバーは自動的に除かれる</p>

          <table class="table table-bordered">
            <tr>
              <th>参加者全員を宛名に入れる：</th>
              <td><%= select_include_all_members(@invitation) %></td>
            </tr>

            <tr>
              <th>誕生月ごとに宛名に入れる：</th>
              <td>
                <% @birth_months.each do |birth_month| %>
                  <%= "#{birth_month}月" %>
                <% end %>
                <%= select_month(@invitation) %>
              </td>
            </tr>

            <tr>
              <th>イベント会合別に宛名を入れる：</th>
              <td>
                <% @event_ids.each do |event_id| %>
                  <%= "第#{Event.find(event_id).cumulative_number}回" %>
                <% end %>
                <%= select_event(@invitation, @events) %>
              </td>
            </tr>

            <tr>
              <th>GTIC幹事メンバーの中でActiveになっている人を含める<br>
              （右上の名前をプルダウンメニューの幹事リストの中でActiveになってる）：</th>
              <td><%= select_include_gtic_members(@invitation) %></td>
            </tr>

            <tr>
              <th>手動で追加</th>
              <td><%= find_member(@invitation) %></td>
            </tr>
          </table>

          <%= link_to send_email_invitation_path(@invitation), class:"btn btn-default btn-lg btn-block", data: { confirm: '送信しますか？' } do %>
            <span class="glyphicon glyphicon-info-sign"></span>送信
          <% end %>
        </div>
      </div>

      <hr>

      <div class="row">
        <div class="col-md-4">
          <%= link_to "送信予定者", view_member_invitation_invitation_path(@invitation), class: "btn btn-default btn-lg" %>
       </div>
      </div>
    <% end %>

    <hr>

    <!-- ここで修正したのもは、必ずinvitation_mailer/invitation.html.erbに同じく修正すること！ -->
    <h3>メールタイトル</h3>
    <hr>
    <p><%= @invitation.title %></p>
    <hr>
    <h3>メール本文</h3>
    <hr>
    <p>（自動的に苗字が入る）様</p>
    <p></p>
    <p><%= simple_format(@invitation.content) %></p>
    <hr>
  </div>
</div>
